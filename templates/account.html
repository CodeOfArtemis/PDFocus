{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="account-container">
    <div class="user-profile">
        <div class="user-avatar">{{ user.username|slice:":2"|upper }}</div>
        <h3>{{ user.get_full_name|default:user.username }}</h3>
        <p>Пользователь с {{ user.date_joined|date:"d.m.Y" }}</p>

        <div class="user-stats">
            <div class="stat-item">
                <span>Файлов:</span>
                <span>{{ documents.count }}</span>
            </div>
            <div class="stat-item">
                <span>Заметок:</span>
                <span>{{ notes.count }}</span>
            </div>
        </div>
    </div>

    <div class="account-content">
        <section class="account-notes">
            <h3>Последние заметки</h3>
            <div class="notes-list">
                {% for note in notes %}
                <div class="note-item">
                    <div class="note-text">{{ note.text }}</div>
                    <div class="note-meta">
                        <span>{{ note.document.title }}</span>
                        <span>Страница {{ note.page_number }}</span>
                    </div>
                </div>
                {% empty %}
                <p>У вас пока нет заметок.</p>
                {% endfor %}
            </div>
        </section>

        <section>
            <h3>Последние файлы</h3>
            <div class="catalog-container">
                {% for doc in documents %}
                <div class="pdf-card small">
                    <div class="pdf-info">
                        <h4><a href="{% url 'detailed' doc.id %}">{{ doc.title }}</a></h4>
                        <div class="pdf-meta">
                            <span>Открыт: {{ doc.last_accessed|date:"d.m.Y H:i" }}</span>
                        </div>
                    </div>
                </div>
                {% empty %}
                <p>У вас пока нет файлов.</p>
                {% endfor %}
            </div>
        </section>
    </div>
</div>
{% endblock %}